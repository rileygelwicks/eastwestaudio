<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.4: http://docutils.sourceforge.net/" />
<title>EWA Manual</title>
<style type="text/css">

/*
:Author: David Goodger
:Contact: goodger@users.sourceforge.net
:Date: $Date: 2005-12-18 01:56:14 +0100 (Sun, 18 Dec 2005) $
:Revision: $Revision: 4224 $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin-left: 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

tt.docutils {
  background-color: #eeeeee }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="ewa-manual">
<h1 class="title">EWA Manual</h1>
<div class="section">
<h1><a id="overview" name="overview">Overview</a></h1>
<p>what EWA is.</p>
</div>
<div class="section">
<h1><a id="deploying-ewa" name="deploying-ewa">Deploying EWA</a></h1>
<div class="section">
<h2><a id="supported-platforms" name="supported-platforms">Supported Platforms</a></h2>
<p>UNIX -- Linux, *BSDs, Mac OS X
Windows might work.</p>
</div>
<div class="section">
<h2><a id="software-installation" name="software-installation">Software Installation</a></h2>
<p>To install, if you already have setuptools installed, you can simply
do:</p>
<pre class="literal-block">
easy_install ewa
</pre>
<p>Or, if you have already installed the source tarball and have unpacked
it, cd into it and type:</p>
<pre class="literal-block">
easy_install .
</pre>
<p>or equivalently:</p>
<pre class="literal-block">
python setup.py install
</pre>
<p>The latter will install setuptools if you don't already have it.</p>
</div>
<div class="section">
<h2><a id="the-managed-audio-directory" name="the-managed-audio-directory">The Managed Audio Directory</a></h2>
<p>Ewa expects audio to be stored in a directory structure like:</p>
<dl class="docutils">
<dt>$basedir/main</dt>
<dd>Your content mp3s go here; you manage this directory and can
organize it however you like. Ewa needs read access to it.</dd>
<dt>$basedir/extras/masters</dt>
<dd>Your &quot;extra&quot; files -- intros, outros, ads, etc. -- go here;
you manage this directory also.  Ewa needs read access to it
also.</dd>
<dt>$basedir/extras/transcoded</dt>
<dd>Ewa manages this directory and needs write access to it; it
stores transcoded versions of the audio files extras/masters
here.</dd>
<dt>$targetdir</dt>
<dd>Ewa manages this directory and needs write access to it; this
is where it stores the spliced files.</dd>
</dl>
<p><tt class="docutils literal"><span class="pre">$basedir</span></tt> and <tt class="docutils literal"><span class="pre">$targetdir</span></tt> are configuration-defined.  You must
specify <tt class="docutils literal"><span class="pre">$basedir</span></tt> in <tt class="docutils literal"><span class="pre">ewa.conf</span></tt>; <tt class="docutils literal"><span class="pre">$targetdir</span></tt> will default to
<tt class="docutils literal"><span class="pre">$basedir/combined</span></tt> if not otherwise specified.</p>
</div>
<div class="section">
<h2><a id="permissions-gotchas" name="permissions-gotchas">Permissions Gotchas</a></h2>
<p>Some care is necessary to ensure that file permissions will be right
for your deployment, especially if you are running both the ewa server
and ewa batch processes, as a variety of users may then be creating
files in the managed directories.</p>
<p>One approach is to create a user and group that the ewa server will
run as, give ownership of the managed directories to it, and make them
both group-writeable and the group permissions sticky.  On Linux, you
might do this:</p>
<pre class="literal-block">
groupadd ewa
useradd -g ewa -s /bin/false  -d $targetdir -c &quot;ewa user&quot; ewa
chown -r ewa:ewa $targetdir $basedir/extras/transcoded
chmod -r g+ws $targetdir $basedir/extras/transcoded
</pre>
<p>While you are at it, creating directories for ewa's pid file and log
file aren't a bad idea:</p>
<pre class="literal-block">
mkdir -p /var/{run,log}/ewa &amp;&amp; chown ewa /var/{run,log}/ewa
</pre>
<p>In <tt class="docutils literal"><span class="pre">ewa.conf</span></tt> you'll want to set the <tt class="docutils literal"><span class="pre">user</span></tt> and <tt class="docutils literal"><span class="pre">group</span></tt>
variables to match the user and group you created.  If you do this,
<tt class="docutils literal"><span class="pre">ewa</span></tt> and <tt class="docutils literal"><span class="pre">ewabatch</span></tt> will need to be run as root (in the case of
<tt class="docutils literal"><span class="pre">ewabatch</span></tt>, most conveniently through <tt class="docutils literal"><span class="pre">sudo</span></tt>), but will drop
credentials to your user/group before it creates any files.</p>
</div>
<div class="section">
<h2><a id="configuration" name="configuration">Configuration</a></h2>
<p>Ewa has two configuration files: <tt class="docutils literal"><span class="pre">ewa.conf</span></tt>, for adminstrative
options, and a rule configuration file, which is used to determine
what the playlists.</p>
<div class="section">
<h3><a id="the-ewa-conf-file" name="the-ewa-conf-file">The <tt class="docutils literal"><span class="pre">ewa.conf</span></tt> File</a></h3>
<p><tt class="docutils literal"><span class="pre">ewa.conf</span></tt> is written in Python; keys defined there that don't start
with an underscore become attributes of the <tt class="docutils literal"><span class="pre">ewa.config.Config</span></tt>
object.  The following values are provided by default:</p>
<ul class="simple">
<li>user</li>
<li>group</li>
<li>more ....</li>
</ul>
<p>The following must be provided:</p>
<blockquote>
<dl class="docutils">
<dt>basedir</dt>
<dd>the root of the managed audio directory.</dd>
</dl>
</blockquote>
<ul class="simple">
<li>rulefile --</li>
</ul>
</div>
<div class="section">
<h3><a id="the-ewa-rule-configuration-file" name="the-ewa-rule-configuration-file">The EWA Rule Configuration File</a></h3>
<p>The rule file can be written in two formats:</p>
<ul class="simple">
<li>Python</li>
<li>ewaconf</li>
</ul>
<p>The most flexible option is Python; if you use this, the Python file
can contain anything as long as it defines a global with the name
&quot;rules&quot;, which should be a <tt class="docutils literal"><span class="pre">Rule</span></tt> object (something that, when
called, returns an iterator that yields filenames relative to the
audioroot that will be merged).  With this hook you can load any sort
of rule system that you might like to devise.</p>
<p>If you want to use the default rule system, however, ewaconf is much
simpler.</p>
</div>
</div>
</div>
</div>
</body>
</html>
